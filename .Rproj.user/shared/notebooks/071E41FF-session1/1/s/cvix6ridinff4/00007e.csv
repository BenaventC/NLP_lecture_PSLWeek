"0",""
"0","# compare to a theoretical distribution"
"0","Y<-foo %>%"
"0","  column_to_rownames(var=""variable"")%>%"
"0","  as.matrix()"
"0",""
"0","n=nrow(typo)"
"0","Z<-Y%*%t(Y) %>%as.data.frame()%>%  "
"0","  rownames_to_column(var=""Channels"")%>% "
"0","  pivot_longer(-Channels,names_to = ""Channelsb"", values_to = ""frequencyT"")%>%"
"0","  mutate(frequencyT=frequencyT*n)"
"0",""
"0","w<- merge(out,Z) %>%"
"0","  mutate(chi2=(frequency-frequencyT)^2/frequencyT)%>%"
"0","  mutate(chi2=ifelse(Channels==Channelsb,0,chi2))"
"0",""
"0","ggplot(data = w, aes(x=Channels, y=Channelsb, fill=chi2)) + "
"0","  geom_tile()+"
"0","  scale_fill_gradient(low = ""Gold"", high = ""Firebrick"", name=""Chi2"")+"
"0","  theme(axis.text.x = element_text(angle = 45, vjust = 1, "
"0","    size = 12, hjust = 1))+"
"0","  labs(x=NULL, y=NULL)"
